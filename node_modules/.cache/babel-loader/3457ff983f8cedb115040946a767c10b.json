{"ast":null,"code":"import { useEffect, useContext } from 'react';\nimport useFetch from 'hooks/useFetch';\nimport { CurrentUserContext } from 'contexts/currentUser';\nimport useLocalStorage from 'hooks/useLocalStorage';\n\nconst CurrentUserChecker = ({\n  children\n}) => {\n  const [, setCurrentUserState] = useContext(CurrentUserContext);\n  const [{\n    response\n  }, doFetch] = useFetch('/user');\n  const [token] = useLocalStorage('token');\n  useEffect(() => {\n    if (!token) {\n      setCurrentUserState(state => ({ ...state,\n        isLoggedIn: false\n      }));\n      return;\n    }\n\n    doFetch();\n    setCurrentUserState(state => ({ ...state,\n      isLoading: true\n    }));\n  }, [doFetch, setCurrentUserState, token]);\n  useEffect(() => {\n    if (!response) {\n      return;\n    }\n\n    setCurrentUserState(state => ({ ...state,\n      isLoggedIn: true,\n      isLoading: false,\n      currentUser: response.user\n    }));\n  }, [response, setCurrentUserState]);\n  return children;\n};\n\nexport default CurrentUserChecker;","map":{"version":3,"sources":["C:/Users/yurBoy/Desktop/bobNode/hook-app/medium_clone/src/node_modules/components/currentUserChecker.js"],"names":["useEffect","useContext","useFetch","CurrentUserContext","useLocalStorage","CurrentUserChecker","children","setCurrentUserState","response","doFetch","token","state","isLoggedIn","isLoading","currentUser","user"],"mappings":"AAAA,SAAQA,SAAR,EAAmBC,UAAnB,QAAoC,OAApC;AAEA,OAAOC,QAAP,MAAqB,gBAArB;AACA,SAAQC,kBAAR,QAAiC,sBAAjC;AACA,OAAOC,eAAP,MAA4B,uBAA5B;;AAEA,MAAMC,kBAAkB,GAAG,CAAC;AAACC,EAAAA;AAAD,CAAD,KAAgB;AACzC,QAAM,GAAGC,mBAAH,IAA0BN,UAAU,CAACE,kBAAD,CAA1C;AACA,QAAM,CAAC;AAACK,IAAAA;AAAD,GAAD,EAAaC,OAAb,IAAwBP,QAAQ,CAAC,OAAD,CAAtC;AACA,QAAM,CAACQ,KAAD,IAAUN,eAAe,CAAC,OAAD,CAA/B;AAEAJ,EAAAA,SAAS,CAAC,MAAM;AACd,QAAI,CAACU,KAAL,EAAY;AACVH,MAAAA,mBAAmB,CAACI,KAAK,KAAK,EAC5B,GAAGA,KADyB;AAE5BC,QAAAA,UAAU,EAAE;AAFgB,OAAL,CAAN,CAAnB;AAIA;AACD;;AAEDH,IAAAA,OAAO;AACPF,IAAAA,mBAAmB,CAACI,KAAK,KAAK,EAC5B,GAAGA,KADyB;AAE5BE,MAAAA,SAAS,EAAE;AAFiB,KAAL,CAAN,CAAnB;AAID,GAdQ,EAcN,CAACJ,OAAD,EAAUF,mBAAV,EAA+BG,KAA/B,CAdM,CAAT;AAgBAV,EAAAA,SAAS,CAAC,MAAM;AACd,QAAI,CAACQ,QAAL,EAAe;AACb;AACD;;AAEDD,IAAAA,mBAAmB,CAACI,KAAK,KAAK,EAC5B,GAAGA,KADyB;AAE5BC,MAAAA,UAAU,EAAE,IAFgB;AAG5BC,MAAAA,SAAS,EAAE,KAHiB;AAI5BC,MAAAA,WAAW,EAAEN,QAAQ,CAACO;AAJM,KAAL,CAAN,CAAnB;AAMD,GAXQ,EAWN,CAACP,QAAD,EAAWD,mBAAX,CAXM,CAAT;AAYA,SAAOD,QAAP;AACD,CAlCD;;AAoCA,eAAeD,kBAAf","sourcesContent":["import {useEffect, useContext} from 'react'\n\nimport useFetch from 'hooks/useFetch'\nimport {CurrentUserContext} from 'contexts/currentUser'\nimport useLocalStorage from 'hooks/useLocalStorage'\n\nconst CurrentUserChecker = ({children}) => {\n  const [, setCurrentUserState] = useContext(CurrentUserContext)\n  const [{response}, doFetch] = useFetch('/user')\n  const [token] = useLocalStorage('token')\n\n  useEffect(() => {\n    if (!token) {\n      setCurrentUserState(state => ({\n        ...state,\n        isLoggedIn: false\n      }))\n      return\n    }\n\n    doFetch()\n    setCurrentUserState(state => ({\n      ...state,\n      isLoading: true\n    }))\n  }, [doFetch, setCurrentUserState, token])\n\n  useEffect(() => {\n    if (!response) {\n      return\n    }\n\n    setCurrentUserState(state => ({\n      ...state,\n      isLoggedIn: true,\n      isLoading: false,\n      currentUser: response.user\n    }))\n  }, [response, setCurrentUserState])\n  return children\n}\n\nexport default CurrentUserChecker\n"]},"metadata":{},"sourceType":"module"}